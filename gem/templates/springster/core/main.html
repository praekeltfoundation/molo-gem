{% extends "base.html" %}
{% load cache wagtailcore_tags core_tags wagtailimages_tags staticfiles comments molo_survey_tags poll_votings competition_tag el_pagination_tags media_tags gem_tags %}


{% block content %}
  {% cache 900 main_banners_top request.site locale_code %}
    {% bannerpages position=0 %}
    {% gembannerpages %}
  {% endcache %}

  {% if not settings.core.SiteSettings.enable_tag_navigation %}
    {% topic_of_the_day %}
    {% latest_listing_homepage num_count=6 %}
    {% section_listing_homepage %}
    {% media_listing_homepage %}
  {% else %}
    {% get_tag_articles tag_count=4 as tag_nav_data %}
    {% paginate 15 tag_nav_data.latest_articles as latest_articles %}
    {% surveys_list personalisable_survey=True %}


    {% include 'core/tags/latest_listing_homepage.html' with articles=latest_articles|slice:"0:3" %}

    <!-- NOTE RENDER -->
    {% with tag_nav_data.tags_list.0.0 as tag %}
      {% if tag %}
      <div class="carousel-teaser">
        <div class="heading heading__component">
          <h2>{{tag.title}}</h2>
        </div>
        {% with tag_nav_data.tags_list.0.1 as tag_articles %}
          {% if tag_articles %}
          <ul class="carousel-teaser-list">
            {% for article in tag_articles %}


              ==>{{article.title}}
            {% endfor %}
            </ul>
          {% endif %}
        {% endwith %}
      </div>
      {% endif %}
    {% endwith %}

    {#{% include "patterns/components/article-teasers/sp_variations/carousel-teaser-listing.html" with tag=tag_nav_data.tags_list.0.0 tag_articles=tag_nav_data.tags_list.0.1 %}#}




    {% if is_via_freebasics %}
      <div class="media-player">
        <div class="media-player__content">
          <div class="media-player__no-player">
            <span class="heading heading__subheading-alt"><h4>{{media.title}}</h4></span>
            <a href="{{ media.youtube_link }}" target="_blank" class="media-player__icon"></a>
            <span class="heading heading__subheading-alt">
            <h4>{% trans "Media will be played externally in a new window" %}</h4>
            </span>
          </div>
        </div>
      </div>
    {% else %}
      {% media_listing_homepage %}
    {% endif %}

    {% bannerpages position=1 %}

    <!-- POLLS AND POLLS VIA SURVEYS -->
    {% poll_page %}
    {% surveys_list only_direct_surveys=True %}

    <!-- NOTE RENDER -->
    {% include 'core/tags/latest_listing_homepage.html' with articles=latest_articles|slice:"3:6" %}

    {% bannerpages position=2 %}
    <!-- YOURWORDS COMPETITION (FOR GCN) VIA SURVEYS -->
    {% surveys_list only_yourwords=True %}

    <!-- NOTE RENDER -->
    {% include 'core/tags/latest_listing_homepage.html' with articles=latest_articles|slice:"6:9" %}

    <!-- SURVEYS -->
    {% surveys_list only_linked_surveys=True %}

    <!-- NOTE RENDER -->
    {% include 'patterns/components/article-teasers/sp_variations/grid-teaser-listing.html' with section=tag_nav_data.sections.0.0 featured_articles=tag_nav_data.sections.0.1 %}
    {% include 'core/tags/latest_listing_homepage.html' with articles=latest_articles|slice:"9:12" %}
    {% include "patterns/components/article-teasers/sp_variations/carousel-teaser-listing.html" with tag=tag_nav_data.tags_list.1.0 tag_articles=tag_nav_data.tags_list.1.1 %}

    {% bannerpages position=3 %}
      <!-- YOURWORDS COMPETITION -->
    {% your_words_competition %}


    <!-- NOTE RENDER -->
    {% include 'core/tags/latest_listing_homepage.html' with articles=latest_articles|slice:"12:15" %}

    {% get_pages %}

    {% trans "Load more" as buttontext %}
    {% url 'home_more' as pagelink %}
    {% url 'home_index' as datalink %}
    {% include "patterns/basics/buttons/sp_variations/button-load-more.html" with type="primary" text=buttontext pagelink=pagelink datalink=datalink %}
  {% endif %}
{% endblock %}
